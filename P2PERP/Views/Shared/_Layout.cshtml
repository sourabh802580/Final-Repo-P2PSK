<!DOCTYPE html>
@{
    Layout = null;
    string currentAction = ViewContext.RouteData.Values["action"].ToString();
    string currentController = ViewContext.RouteData.Values["controller"].ToString();
    string role = Session["RoleId"] != null ? Session["RoleId"].ToString() : "";
    if (Session["StaffCode"] == null)
    {
        Response.Redirect("~/Account/Logout");
    }
}
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="robots" content="noindex, nofollow" />

    <title>@ViewBag.Title</title>

    <meta name="description" content="" />
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="~/Content/images/favicon/favicon.ico" />
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="~/Content/font-family-inter.css" />
    <link rel="stylesheet" href="~/Content/iconify-icons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="~/Content/node-waves.css" />
    <link rel="stylesheet" href="~/Content/core.css" />
    <link rel="stylesheet" href="~/Content/demo.css" />
    <link rel="stylesheet" href="~/Content/Site.css" />
    <link rel="stylesheet" href="~/Content/Layout.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="~/Content/perfect-scrollbar.css" />
    <link rel="stylesheet" href="~/Content/apex-charts.css" />
    <link rel="stylesheet" href="~/Content/dataTables.dataTables.min.css" />
    <link rel="stylesheet" href="~/Content/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="~/Content/bootstrap-icons-1.11.3/package/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="~/Content/remixicon-4.6.0/package/fonts/remixicon.css" />
    <link rel="stylesheet" href="~/Content/jquery-ui.css" />
    <link rel="stylesheet" type="text/css" href="~/Content/daterangepicker.css" />
    <link rel="stylesheet" href="~/Content/toastr.min.css" />

    <!-- jQuery -->
    <script src="~/Scripts/jquery-3.7.1.min.js"></script>
    <script src="~/Scripts/jquery-ui.min.js"></script>

    <!-- Bootstrap & Popper -->
    <script src="~/Scripts/popper.js"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>

    <!-- Plugins & Helpers -->
    <script src="~/Scripts/helpers.js"></script>
    <script src="~/Scripts/config.js"></script>
    <script src="~/Scripts/node-waves.js"></script>
    <script src="~/Scripts/perfect-scrollbar.js"></script>
    <script src="~/Scripts/menu.js"></script>

    <!-- DataTables & Export -->
    <script src="~/Scripts/dataTables.min.js"></script>
    <script src="~/Scripts/dataTables.buttons.min.js"></script>
    <script src="~/Scripts/jszip.min.js"></script>
    <script src="~/Scripts/pdfmake.min.js"></script>
    <script src="~/Scripts/vfs_fonts.js"></script>
    <script src="~/Scripts/buttons.html5.min.js"></script>
    <script src="~/Scripts/buttons.print.min.js"></script>

    <!-- Validation -->
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>

    <!-- Charts -->
    <script src="~/Scripts/highcharts.js"></script>
    <script src="~/Scripts/exporting.js"></script>
    <script src="~/Scripts/accessibility.js"></script>
    <script src="~/Scripts/apexcharts.js"></script>

    <!-- Date & Time -->
    <script src="~/Scripts/moment.min.js"></script>
    <script type="text/javascript" src="~/Scripts/daterangepicker.min.js"></script>

    <!-- Notifications -->
    <script src="~/Scripts/toastr.min.js"></script>
    <script src="~/Scripts/sweetalert2@11.js"></script>

    <!-- Calendar -->
    <script src="~/Scripts/fullcalendar@6.1.19_index.global.min.js"></script>
    <script src="~/Scripts/bootstrap5@6.1.19_index.global.min.js"></script>

    <!-- Main JS -->
    <script src="~/Scripts/main.js"></script>

    <!-- Page-specific JS -->
    <script src="~/Scripts/dashboards-analytics.js"></script>

    <style>
                /* Enhanced Gradient Background */
                .bg-gradient-primary {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #667eea 100%) !important;
                    background-size: 200% 200% !important;
                    animation: gradientShift 15s ease infinite;
                }

                @@keyframes gradientShift {
                    0% {
                        background-position: 0% 50%;
                    }

                    50% {
                        background-position: 100% 50%;
                    }

                    100% {
                        background-position: 0% 50%;
                    }
                }

                /* Brand Logo Animation */
                .brand-hover {
                    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }

                    .brand-hover:hover {
                        transform: translateY(-2px);
                    }

                .logo-text {
                    position: relative;
                    overflow: hidden;
                }

                    .logo-text::after {
                        content: '';
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        width: 0;
                        height: 2px;
                        background: rgba(255, 255, 255, 0.8);
                        transition: width 0.4s ease;
                    }

                .brand-hover:hover .logo-text::after {
                    width: 100%;
                }

                .menu-divider {
                    border-top: 1px solid rgba(255, 255, 255, 0.15);
                    margin: 0 1.5rem;
                    position: relative;
                    overflow: hidden;
                }

                    .menu-divider::after {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: -100%;
                        width: 100%;
                        height: 1px;
                        background: rgba(255, 255, 255, 0.3);
                        animation: shimmer 3s infinite;
                    }

                @@keyframes shimmer {
                    0% {
                        left: -100%;
                    }

                    100% {
                        left: 100%;
                    }
                }

                /* Menu Items Animation */
                .menu-item-hover {
                    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                    color: rgba(255, 255, 255, 0.85) !important;
                    margin: 4px 12px;
                    position: relative;
                    overflow: hidden;
                }

                    .menu-item-hover::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: -100%;
                        width: 100%;
                        height: 100%;
                        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
                        transition: left 0.5s;
                    }

                    .menu-item-hover:hover::before {
                        left: 100%;
                    }

                    .menu-item-hover:hover, .menu-item.active > .menu-link {
                        background: rgba(255, 255, 255, 0.15) !important;
                        color: white !important;
                        transform: translateX(8px);
                        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                    }

                /* Submenu Animation */
                .menu-sub {
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 10px;
                    margin: 6px 16px;
                    padding: 6px 0;
                    overflow: hidden;
                    max-height: 0;
                    opacity: 0;
                    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }

                .menu-item.open .menu-sub {
                    max-height: 500px;
                    opacity: 1;
                }

                .slide-transition {
                    transform-origin: top;
                }

                .submenu-item-hover {
                    transition: all 0.3s ease;
                    color: rgba(255, 255, 255, 0.75) !important;
                    margin: 2px 8px;
                    position: relative;
                    overflow: hidden;
                }

                    .submenu-item-hover::before {
                        content: '';
                        position: absolute;
                        left: 0;
                        top: 0;
                        height: 100%;
                        width: 3px;
                        background: rgba(255, 255, 255, 0.5);
                        transform: scaleY(0);
                        transition: transform 0.3s ease;
                    }

                    .submenu-item-hover:hover, .menu-item.active .submenu-item-hover {
                        background: rgba(255, 255, 255, 0.1) !important;
                        color: white !important;
                        padding-left: 20px;
                        transform: translateX(4px);
                    }

                        .submenu-item-hover:hover::before, .menu-item.active .submenu-item-hover::before {
                            transform: scaleY(1);
                        }

                /* Arrow Animation */
                .transition-arrow {
                    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }

                .menu-item.open .transition-arrow {
                    transform: rotate(180deg);
                }

                /* Active State Enhancement */
                .menu-item.active > .menu-link {
                    background: rgba(255, 255, 255, 0.2) !important;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                }

                /* Scrollbar Styling */
                .menu-inner::-webkit-scrollbar {
                    width: 4px;
                }

                .menu-inner::-webkit-scrollbar-track {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }

                .menu-inner::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.3);
                    border-radius: 10px;
                }

                    .menu-inner::-webkit-scrollbar-thumb:hover {
                        background: rgba(255, 255, 255, 0.5);
                    }

                /* Logo Background Enhancement */
                .logo-bg {
                    background: rgba(255, 255, 255, 0.15);
                    border-radius: 10px;
                    padding: 6px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                }

                .brand-hover:hover .logo-bg {
                    background: rgba(255, 255, 255, 0.25);
                    transform: scale(1.05);
                }

                /* Menu Icon Styling */
                .menu-icon {
                    width: 22px;
                    text-align: center;
                    transition: transform 0.3s ease;
                }

                .menu-item-hover:hover .menu-icon {
                    transform: scale(1.1);
                }

                /* Ripple Effect */
                .ripple-effect {
                    position: absolute;
                    border-radius: 50%;
                    background: rgba(255, 255, 255, 0.6);
                    transform: scale(0);
                    animation: ripple 0.6s linear;
                    pointer-events: none;
                    width: 20px;
                    height: 20px;
                    margin-left: -10px;
                    margin-top: -10px;
                }

                @@keyframes ripple {
                    to {
                        transform: scale(4);
                        opacity: 0;
                    }
                }

                /* Ensure menu items have relative positioning for ripple */
                .menu-link {
                    position: relative;
                    overflow: hidden;
                }

                /* Global Loader Styles */
                .global-loader {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.7);
                    backdrop-filter: blur(5px);
                    z-index: 9999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .loader-container {
                    background: white;
                    padding: 2rem;
                    border-radius: 15px;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                    text-align: center;
                    min-width: 200px;
                    animation: slideUp 0.3s ease-out;
                }



                @@keyframes spinner-glow {
                    from {
                        box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
                    }

                    to {
                        box-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
                    }
                }

                /* Enhanced Navbar Styles */
                .enhanced-navbar {
                    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
                    backdrop-filter: blur(10px);
                    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
                    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
                    transition: all 0.3s ease;
                    padding: 0.75rem 1rem;
                }

                .navbar-brand-section {
                    min-width: 250px;
                }

                /* Menu Toggle Button */
                .menu-toggle-btn {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    width: 40px;
                    height: 40px;
                    border-radius: 12px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                    color: white !important;
                }

                    .menu-toggle-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                    }

                /* Breadcrumb */
                .breadcrumb {
                    background: transparent;
                    margin-bottom: 0;
                    padding: 0.5rem 0;
                }

                .breadcrumb-item a {
                    color: #667eea;
                    font-weight: 500;
                    transition: color 0.3s ease;
                }

                    .breadcrumb-item a:hover {
                        color: #764ba2;
                    }

                .breadcrumb-item.active {
                    color: #6c757d;
                    font-weight: 500;
                }

                /* Search Bar */
                .nav-search-container {
                    min-width: 300px;
                }

                .search-input {
                    border-radius: 12px;
                    border: 1px solid #e0e0e0;
                    padding: 0.75rem 1rem;
                    transition: all 0.3s ease;
                    background: rgba(255, 255, 255, 0.8);
                }

                    .search-input:focus {
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                        background: white;
                    }

                .input-group-text {
                    border-radius: 12px 0 0 12px;
                    border: 1px solid #e0e0e0;
                    border-right: none;
                    background: rgba(255, 255, 255, 0.8);
                }

                /* Quick Actions */
                .quick-actions-btn {
                    background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
                    color: #fff !important;
                    border: none;
                    transition: all 0.3s ease;
                }

                    .quick-actions-btn:hover {
                        transform: scale(1.05);
                        box-shadow: 0 4px 15px rgba(255, 165, 0, 0.3);
                    }

                .quick-actions-menu {
                    min-width: 280px;
                    border-radius: 16px;
                    border: none;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
                }

                    .quick-actions-menu .dropdown-header {
                        font-weight: 700;
                        color: #2c3e50;
                        font-size: 1.1rem;
                    }

                    .quick-actions-menu .dropdown-item {
                        border-radius: 8px;
                        padding: 0.75rem 1rem;
                        margin: 0.25rem 0;
                        transition: all 0.3s ease;
                    }

                        .quick-actions-menu .dropdown-item:hover {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            transform: translateX(5px);
                        }

                /* Theme Toggle */
                .theme-toggle-btn {
                    background: rgba(255, 255, 255, 0.9);
                    border: 1px solid #e0e0e0;
                    transition: all 0.3s ease;
                }

                    .theme-toggle-btn:hover {
                        background: white;
                        border-color: #667eea;
                        transform: rotate(15deg);
                    }

                /* Notification Enhancement */
                .notification-btn {
                    background: rgba(255, 255, 255, 0.9);
                    border: 1px solid #e0e0e0;
                    transition: all 0.3s ease;
                }

                    .notification-btn:hover {
                        background: white;
                        border-color: #667eea;
                        transform: translateY(-2px);
                    }

                .notification-badge {
                    animation: pulse 2s infinite;
                }

                @@keyframes pulse {
                    0% {
                        transform: scale(1);
                    }

                    50% {
                        transform: scale(1.1);
                    }

                    100% {
                        transform: scale(1);
                    }
                }

                .notification-dropdown {
                    min-width: 380px;
                    border-radius: 16px;
                    border: none;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
                }

                    .notification-dropdown .dropdown-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-radius: 16px 16px 0 0;
                        margin: -1px -1px 0 -1px;
                    }

                    .notification-dropdown .list-group-item {
                        border: none;
                        padding: 1rem;
                        transition: all 0.3s ease;
                    }

                        .notification-dropdown .list-group-item:hover {
                            background: #f8f9fa;
                            transform: translateX(5px);
                        }

                /* User Dropdown Enhancement */
                .user-avatar-btn .avatar {
                    transition: all 0.3s ease;
                }

                .user-avatar-btn:hover .avatar {
                    transform: scale(1.1);
                    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                }

                .avatar-status {
                    position: absolute;
                    bottom: 2px;
                    right: 2px;
                    width: 12px;
                    height: 12px;
                    border: 2px solid white;
                    border-radius: 50%;
                }

                .user-dropdown {
                    min-width: 320px;
                    border-radius: 16px;
                    border: none;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
                }

                    .user-dropdown .dropdown-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-radius: 16px 16px 0 0;
                        margin: -1px -1px 0 -1px;
                    }

                    .user-dropdown .dropdown-item {
                        border-radius: 8px;
                        padding: 0.75rem 1rem;
                        margin: 0.25rem 0;
                        transition: all 0.3s ease;
                    }

                        .user-dropdown .dropdown-item:hover {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            transform: translateX(5px);
                        }

                /* Enhanced Content Area */
                .content-wrapper {
                    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                    min-height: calc(100vh - 80px);
                }

                /* Card Enhancements */
                .card {
                    border: none;
                    border-radius: 16px;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    transition: all 0.3s ease;
                    background: white;
                }

                    .card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
                    }

                .card-header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border-radius: 16px 16px 0 0 !important;
                    border: none;
                    padding: 1.25rem 1.5rem;
                }

                /* Button Enhancements */
                .btn {
                    border-radius: 10px;
                    font-weight: 600;
                    transition: all 0.3s ease;
                    border: none;
                }

                .btn-primary {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                }

                    .btn-primary:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                    }

                /* Table Enhancements */
                .table {
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
                }

                    .table thead th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 1rem;
                        font-weight: 600;
                    }

                    .table tbody tr {
                        transition: all 0.3s ease;
                    }

                        .table tbody tr:hover {
                            background: rgba(102, 126, 234, 0.05);
                            transform: scale(1.01);
                        }

                /* Form Enhancements */
                .form-control {
                    border-radius: 10px;
                    border: 1px solid #e0e0e0;
                    padding: 0.75rem 1rem;
                    transition: all 0.3s ease;
                }

                    .form-control:focus {
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                    }

                /* Responsive Design */
                @@media (max-width: 1199.98px) {
                    .navbar-brand-section {
                        min-width: auto;
                    }

                    .nav-search-container {
                        min-width: 250px;
                    }

                    .notification-dropdown {
                        min-width: 320px;
                    }
                }

                @@media (max-width: 767.98px) {
                    .enhanced-navbar {
                        padding: 0.5rem;
                    }

                    .nav-search-container {
                        display: none !important;
                    }

                    .quick-actions-dropdown {
                        display: none !important;
                    }

                    .notification-dropdown {
                        min-width: 280px;
                        position: fixed !important;
                        top: 70px !important;
                        right: 10px !important;
                        left: 10px !important;
                        width: auto !important;
                    }

                    .user-dropdown {
                        min-width: 280px;
                        position: fixed !important;
                        top: 70px !important;
                        right: 10px !important;
                        left: 10px !important;
                        width: auto !important;
                    }
                }

                /* spinner rotate (MUST have this) */
                /*@@keyframes spinner-rotate {
          100% { transform: rotate(360deg); }
        }*/

             /* HTML: <div class="loader"></div> */
/* HTML: <div class="loader"></div> */
/* HTML: <div class="loader"></div> */
/* HTML: <div class="loader"></div> */
.loader {
  width: 28px;
  aspect-ratio: 1;
  border-radius: 50%;
  background: #F10C49;
  animation: l7 2s infinite;
}
@@keyframes l7 {
  0%,
  100%  {transform:translate(-30px,-30px);box-shadow:  0     0 #F4DD51, 0     0 #E3AAD6}
  12.5% {transform:translate( 30px,-30px);box-shadow: -15px  0 #F4DD51,-30px  0 #E3AAD6}
  25%   {transform:translate( 30px,-30px);box-shadow:  0     0 #F4DD51, 0     0 #E3AAD6}
  37.5% {transform:translate( 30px, 30px);box-shadow:  0 -15px #F4DD51, 0 -30px #E3AAD6}
  50%   {transform:translate( 30px, 30px);box-shadow:  0     0 #F4DD51, 0     0 #E3AAD6}
  62.5% {transform:translate(-30px, 30px);box-shadow:  15px  0 #F4DD51, 30px  0 #E3AAD6}
  75%   {transform:translate(-30px, 30px);box-shadow:  0     0 #F4DD51, 0     0 #E3AAD6}
  87.5% {transform:translate(-30px,-30px);box-shadow:  0  15px #F4DD51, 0  30px #E3AAD6}
}
                /* Dark theme support */
                [data-bs-theme="dark"] .enhanced-navbar {
                    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%) !important;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                }

                [data-bs-theme="dark"] .search-input,
                [data-bs-theme="dark"] .input-group-text {
                    background: rgba(45, 55, 72, 0.8);
                    border-color: #4a5568;
                    color: white;
                }

                [data-bs-theme="dark"] .theme-toggle-btn,
                [data-bs-theme="dark"] .notification-btn {
                    background: rgba(45, 55, 72, 0.8);
                    border-color: #4a5568;
                    color: white;
                }

                [data-bs-theme="dark"] .content-wrapper {
                    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
                }

                [data-bs-theme="dark"] .card {
                    background: #2d3748;
                    color: white;
                }

        /* Navbar Toggle Button */
        #navbarMenuToggle {
            background: rgba(255, 255, 255, 0.2) !important;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s ease;
            margin-right: 1rem;
        }

            #navbarMenuToggle:hover {
                background: rgba(255, 255, 255, 0.3) !important;
                transform: scale(1.05);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            }

/* Ensure proper sidebar positioning and transitions */
.layout-menu {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    z-index: 1000;
    transition: transform 0.3s ease-in-out;
    transform: translateX(0);
}

.layout-menu-hidden {
    transform: translateX(-100%) !important;
}

.layout-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.layout-overlay.show {
    opacity: 1;
    visibility: visible;
}

/* Adjust layout container for sidebar */
.layout-container {
    margin-left: 0;
    transition: margin-left 0.3s ease;
}

/* Desktop - sidebar always visible */
@@media (min-width: 1200px) {
    .layout-menu {
        position: relative !important;
        transform: translateX(0) !important;
        height: 100vh;
    }

    .layout-menu-hidden {
        transform: translateX(-100%) !important;
    }

    .layout-overlay {
        display: none !important;
    }

    .layout-container {
        margin-left: 0;
    }
}

/* Mobile - sidebar hidden by default */
@@media (max-width: 1199.98px) {
    .layout-menu {
        transform: translateX(-100%);
    }

    .layout-overlay {
        display: block;
    }
}
    </style>
</head>
<body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
        <div class="layout-container scroll-container">

            <!-- Enhanced Animated Menu -->
            <aside id="layout-menu" class="layout-menu menu-vertical menu " style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)!important;">
                <!-- Brand Section with Animation -->
                <div class="app-brand demo py-4 mb-3">
                    <a href="index" class="app-brand-link d-flex align-items-center text-decoration-none brand-hover">
                        <span class="app-brand-logo me-3">
                            <span class="logo-bg">
                                <svg width="34" height="28" viewBox="0 0 250 196" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.3002 1.25469L56.655 28.6432C59.0349 30.1128 60.4839 32.711 60.4839 35.5089V160.63C60.4839 163.468 58.9941 166.097 56.5603 167.553L12.2055 194.107C8.3836 196.395 3.43136 195.15 1.14435 191.327C0.395485 190.075 0 188.643 0 187.184V8.12039C0 3.66447 3.61061 0.0522461 8.06452 0.0522461C9.56056 0.0522461 11.0271 0.468577 12.3002 1.25469Z" fill="currentColor" />
                                    <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M0 65.2656L60.4839 99.9629V133.979L0 65.2656Z" fill="black" />
                                    <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M0 65.2656L60.4839 99.0795V119.859L0 65.2656Z" fill="black" />
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M237.71 1.22393L193.355 28.5207C190.97 29.9889 189.516 32.5905 189.516 35.3927V160.631C189.516 163.469 191.006 166.098 193.44 167.555L237.794 194.108C241.616 196.396 246.569 195.151 248.856 191.328C249.605 190.076 250 188.644 250 187.185V8.09597C250 3.64006 246.389 0.027832 241.935 0.027832C240.444 0.027832 238.981 0.441882 237.71 1.22393Z" fill="currentColor" />
                                    <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M250 65.2656L189.516 99.8897V135.006L250 65.2656Z" fill="black" />
                                    <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M250 65.2656L189.516 99.0497V120.886L250 65.2656Z" fill="black" />
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2787 1.18923L125 70.3075V136.87L0 65.2465V8.06814C0 3.61223 3.61061 0 8.06452 0C9.552 0 11.0105 0.411583 12.2787 1.18923Z" fill="currentColor" />
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2787 1.18923L125 70.3075V136.87L0 65.2465V8.06814C0 3.61223 3.61061 0 8.06452 0C9.552 0 11.0105 0.411583 12.2787 1.18923Z" fill="white" fill-opacity="0.15" />
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M237.721 1.18923L125 70.3075V136.87L250 65.2465V8.06814C250 3.61223 246.389 0 241.935 0C240.448 0 238.99 0.411583 237.721 1.18923Z" fill="currentColor" />
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M237.721 1.18923L125 70.3075V136.87L250 65.2465V8.06814C250 3.61223 246.389 0 241.935 0C240.448 0 238.99 0.411583 237.721 1.18923Z" fill="white" fill-opacity="0.3" />
                                </svg>
                            </span>
                        </span>
                        <span class="app-brand-text fw-bold fs-3 text-white logo-text">P2PERP</span>
                    </a>
                </div>

                <div class="menu-divider my-3"></div>

                <!-- Menu Items -->
                <ul class="menu-inner py-2" style="overflow: auto; scrollbar-width: none;">


                    @if (role == "5") // Purchase Requisition User
                    {
                        <li class="menu-item @(currentAction.Contains("CreatePRADDItemPSM") || currentAction.Contains("AllRequisitionSP") ? "active open" : "")">
                            <a href="javascript:void(0);" class="menu-link menu-toggle d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-layout-text-sidebar me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Purchase Requisition">Purchase Requisition</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub slide-transition">
                                <li class="menu-item @(currentAction == "CreatePRADDItemPSM" ? "active" : "")">
                                    <a href="@Url.Action("CreatePRADDItemPSM", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-box me-3"></i>
                                        <div data-i18n="Stock Requirement">Stock Requirement</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "AllRequisitionSP" ? "active" : "")">
                                    <a href="@Url.Action("AllRequisitionSP", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-collection me-3"></i>
                                        <div data-i18n="All Requisition">All Requisition</div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    }

                    @if (role == "6") // RFQ User
                    {
                        <li class="menu-item @(currentAction == "QuotationSJ" ? "active" : "")">
                            <a href="@Url.Action("QuotationSJ", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                <i class="menu-icon tf-icons bi bi-list-ul me-3"></i>
                                <div data-i18n="All RFQ">All RFQ</div>
                            </a>
                        </li>
                    }

                    @if (role == "7") // Supplier Quotation User
                    {
                        <li class="menu-item @(currentAction.Contains("ShowAllRFQsVNK") ? "active" : "")">
                            <a href="@Url.Action("ShowAllRFQsVNK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                <i class="menu-icon tf-icons bi bi-collection me-3"></i>
                                <div data-i18n="All RQ">All RQ</div>
                            </a>
                        </li>
                    }

                    @if (role == "8") // Purchase Manager
                    {
                        <li class="menu-item @(currentAction.Contains("UserDashboardPRK") || currentAction.Contains("ShowPendingPRPRK") || currentAction.Contains("SupplierQuotationAMG") || currentAction.Contains("PurchaseOrdersVNK") || currentAction.Contains("VenderManagementOK")  ? "active open" : "")">
                            <a href="javascript:void(0);" class="menu-link menu-toggle d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-speedometer me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Manager Dashboard">Manager Dashboard</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub slide-transition">
                                <li class="menu-item @(ViewContext.RouteData.Values["action"].ToString() == "UserDashboardPRK" ? "active" : "")">
                                    <a href="@Url.Action("UserDashboardPRK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <div data-i18n="Purchase Dashboard">Purchase Dashboard</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction.Contains("PurchaseRequisition") ? "active" : "")">
                                    <a href="@Url.Action("ShowPendingPRPRK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-bag me-3"></i>
                                        <div data-i18n="Purchase Requisition">Purchase Requisition</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction.Contains("SupplierQuotation") ? "active" : "")">
                                    <a href="@Url.Action("SupplierQuotationAMG", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-briefcase me-3"></i>
                                        <div data-i18n="Supplier Quotation">Supplier Quotation</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction.Contains("PurchaseOrder") ? "active" : "")">
                                    <a href="@Url.Action("PurchaseOrdersVNK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-cart-check me-3"></i>
                                        <div data-i18n="Purchase Order">Purchase Order</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction.Contains("Master") ? "active" : "")">
                                    <a href="@Url.Action("VenderManagementOK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-people me-3"></i>
                                        <div data-i18n="Vendor Management">Vendor Management</div>
                                    </a>
                                </li>
                            </ul>
                        </li>

                        <li class="menu-item @(currentAction.Contains("PurchaseRequestTableAT") || currentAction.Contains("RFQReportAT") || currentAction.Contains("PurchaseOrderReportAT") ? "active open" : "")">
                            <a href="javascript:void(0);" class="menu-link menu-toggle d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-bar-chart-line me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Reports">Reports</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub slide-transition">
                                <li class="menu-item @(currentAction == "PurchaseRequestTableAT" ? "active" : "")">
                                    <a href="@Url.Action("PurchaseRequestTableAT", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text me-3"></i>
                                        <div data-i18n="PR Reports">PR Reports</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "RFQReportAT" ? "active" : "")">
                                    <a href="@Url.Action("RFQReportAT", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text me-3"></i>
                                        <div data-i18n="RFQ Reports">RFQ Reports</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "PurchaseOrderReportAT" ? "active" : "")">
                                    <a href="@Url.Action("PurchaseOrderReportAT", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text me-3"></i>
                                        <div data-i18n="PO Reports">PO Reports</div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    }

                    @if (role == "9") // PO User
                    {
                        <li class="menu-item @(currentAction.Contains("SelectedQuotationListShowOK") || currentAction.Contains("PurchaseOrederHistoryOK") ? "active open" : "")">
                            <a href="javascript:void(0);" class="menu-link menu-toggle d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-cart4 me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="PO User Dashboard">PO User Dashboard</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub slide-transition">
                                <li class="menu-item @(currentAction == "SelectedQuotationListShowOK" ? "active" : "")">
                                    <a href="@Url.Action("SelectedQuotationListShowOK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-inbox me-3"></i>
                                        <div data-i18n="Receive Quotation">Receive Quotation</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "PurchaseOrederHistoryOK" ? "active" : "")">
                                    <a href="@Url.Action("PurchaseOrederHistoryOK", "Purchase")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-clock-history me-3"></i>
                                        <div data-i18n="Purchase Order History">Purchase Order History</div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    }

                    @if (role == "2" || role == "3" || role == "4") // Inventory Roles
                    {
                        if (role == "2")
                        {
                            <li class="menu-item @(currentAction == "Index" ? "active" : "")">
                                <a href="@Url.Action("Index", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                    <i class="menu-icon tf-icons bi bi-speedometer2"></i>
                                    <div data-i18n="Inventory Dashboard">Inventory Dashboard</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction.Contains("CategorySSG") || currentAction.Contains("WHIndex") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-gear"></i>
                                    <div data-i18n="Master Data">Master Data</div>
                                    <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "CategorySSG" ? "active" : "")">
                                        <a href="@Url.Action("CategorySSG", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-box-seam"></i>
                                            <div data-i18n="Item Master">Item Master</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "WHIndex" ? "active" : "")">
                                        <a href="@Url.Action("WHIndex", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-grid-3x3-gap"></i>
                                            <div data-i18n="Assign Bin">Assign Bin</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        if (role == "2" || role == "3")
                        {
                            <li class="menu-item @(currentAction.Contains("ReceiveMaterialDRB") || currentAction.Contains("IssueInHouseDRB") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-arrow-left-right"></i>
                                    <div data-i18n="Transaction">Transaction</div>
                                    <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "ReceiveMaterialDRB" ? "active" : "")">
                                        <a href="@Url.Action("ReceiveMaterialDRB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-download"></i>
                                            <div data-i18n="Receive Material">Receive Material</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "IssueInHouseDRB" ? "active" : "")">
                                        <a href="@Url.Action("IssueInHouseDRB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-upload"></i>
                                            <div data-i18n="Issue In House">Issue In House</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        if (role == "2" || role == "4")
                        {
                            <li class="menu-item @(currentAction == "StocksCheakLM" ? "active" : "")">
                                <a href="@Url.Action("StocksCheakLM", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                    <i class="menu-icon tf-icons bi bi-clipboard-check"></i>
                                    <div data-i18n="Stock Check">Stock Check</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction.Contains("ShowStocklevelMHB") || currentAction.Contains("JITStockMHB") || currentAction.Contains("ISRStockMHB") || currentAction.Contains("NewplanMHB") || currentAction.Contains("StockMasterRHK") || currentAction.Contains("ReqMasterRHK") || currentAction.Contains("ManagerApprovalMHB") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-bar-chart"></i>
                                    <div data-i18n="Stock Planning">Stock Planning</div>
                                    <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "ShowStocklevelMHB" ? "active" : "")">
                                        <a href="@Url.Action("ShowStocklevelMHB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-graph-up"></i>
                                            <div data-i18n="Analyze">Analyze</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "JITStockMHB" ? "active" : "")">
                                        <a href="@Url.Action("JITStockMHB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-clock-history"></i>
                                            <div data-i18n="Just In Time">Just In Time</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "ISRStockMHB" ? "active" : "")">
                                        <a href="@Url.Action("ISRStockMHB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-clock-history"></i>
                                            <div data-i18n="ISR Stock">ISR Stock</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "NewplanMHB" ? "active" : "")">
                                        <a href="@Url.Action("NewplanMHB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-cash-stack"></i>
                                            <div data-i18n="MRP">MRP</div>
                                        </a>
                                    </li>
                                    @if (role == "2")
                                    {
                                        <li class="menu-item @(currentAction == "ManagerApprovalMHB" ? "active" : "")">
                                            <a href="@Url.Action("ManagerApprovalMHB", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                                <i class="menu-icon tf-icons bi bi-person-check"></i>
                                                <div data-i18n="Manager Approval">Manager Approval</div>
                                            </a>
                                        </li>
                                        <li class="menu-item @(currentAction == "ReqMasterRHK" ? "active" : "")">
                                            <a href="@Url.Action("ReqMasterRHK", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                                <i class="menu-icon tf-icons bi bi-list-check"></i>
                                                <div data-i18n="Requirement List">Requirement List</div>
                                            </a>
                                        </li>
                                        <li class="menu-item @(currentAction == "StockMasterRHK" ? "active" : "")">
                                            <a href="@Url.Action("StockMasterRHK", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                                <i class="menu-icon tf-icons bi bi-bar-chart-steps"></i>
                                                <div data-i18n="StockPlan List">StockPlan List</div>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>
                        }

                        if (role == "2")
                        {
                            <li class="menu-item @(currentAction.Contains("CurrentStockReportAMG") || currentAction.Contains("ReceivedMaterialReport") || currentAction.Contains("InhouseTransferReportVAMG") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-bar-chart-line"></i>
                                    <div data-i18n="Reports">Reports</div>
                                    <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                                </a>
                                <ul class="menu-sub">
                                    @*<li class="menu-item @(currentAction == "CurrentStockReportAMG" ? "active" : "")">
                                        <a href="@Url.Action("CurrentStockReportAMG", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="Current Stock Reports">Current Stock Reports</div>
                                        </a>
                                    </li>*@
                                    <li class="menu-item @(currentAction == "ReceivedMaterialReport" ? "active" : "")">
                                        <a href="@Url.Action("ReceivedMaterialReportAMG", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="Received Material Reports">Received Material Reports</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "InhouseTransferReportVAMG" ? "active" : "")">
                                        <a href="@Url.Action("InhouseTransferReportVAMG", "Inventory")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="Inhouse Transfer Reports">Inhouse Transfer Reports</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }
                    }

                    @if (role == "10" || role == "11" || role == "12") // GRN Roles
                    {
                        <li class="menu-item @(currentAction == "GRNDashboardRHK" ? "active" : "")">
                            <a href="@Url.Action("GRNDashboardRHK", "GRN")" class="menu-link d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-speedometer2 me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Dashboard">Dashboard</div>
                            </a>
                        </li>

                        <li class="menu-item @(currentAction == "GRNSSG" || currentAction == "RejectedGoods" ? "active open" : "")" id="grn-transaction-menu">
                            <a href="javascript:void(0);" class="menu-link menu-toggle d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-arrow-left-right me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Transaction">Transaction</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub slide-transition">
                                <li class="menu-item @(currentAction == "GRNSSG" ? "active" : "")">
                                    <a href="@Url.Action("GRNSSG", "GRN")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-download me-3"></i>
                                        <div data-i18n="GRN Entry">GRN Entry</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "RejectedGoods" ? "active" : "")">
                                    <a href="@Url.Action("RejectedGoods", "GRN")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-upload me-3"></i>
                                        <div data-i18n="Return Good">Return Good</div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="menu-item @(currentAction.Contains("Report") ? "active open" : "")">
                            <a href="javascript:void(0);" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover menu-toggle">
                                <i class="menu-icon tf-icons bi bi-bar-chart-line"></i>
                                <div data-i18n="Reports">Reports</div>
                                <i class="menu-arrow bi bi-chevron-down ms-auto transition-arrow"></i>
                            </a>
                            <ul class="menu-sub">
                                <li class="menu-item @(currentAction == "ApprovedPOReportPSM" ? "active" : "")">
                                    <a href="@Url.Action("ApprovedPOReportPSM", "GRN")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                        <div data-i18n="Approved PO Reports">Approved PO Reports</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "GRNSummaryReportPSM" ? "active" : "")">
                                    <a href="@Url.Action("GRNSummaryReportPSM", "GRN")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                        <div data-i18n="GRN Summary Reports">GRN Summary Reports</div>
                                    </a>
                                </li>
                                <li class="menu-item @(currentAction == "GoodsReturnSummaryReportPSM" ? "active" : "")">
                                    <a href="@Url.Action("GoodsReturnSummaryReportPSM", "GRN")" class="menu-link d-flex align-items-center rounded-2 py-2 px-3 submenu-item-hover">
                                        <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                        <div data-i18n="Goods Return Reports">Goods Return Reports</div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    }

                    @if (role == "13" || role == "14" || role == "15") // Quality Check Roles
                    {
                        <li class="menu-item @(currentAction == "QCheckDashboardNAM" ? "active" : "")">
                            <a href="@Url.Action("QCheckDashboardNAM", "Quality")" class="menu-link d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-speedometer2 me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Dashboard">Dashboard</div>
                            </a>
                        </li>

                        <li class="menu-item @(currentAction == "IndexRG" ? "active" : "")">
                            <a href="@Url.Action("IndexRG", "Quality")" class="menu-link d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-check2-square me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Check Quality">Check Quality</div>
                            </a>
                        </li>

                        <li class="menu-item @(currentAction == "QalityCheackReports" ? "active" : "")">
                            <a href="@Url.Action("QalityCheackReports", "Quality")" class="menu-link d-flex align-items-center rounded-3 py-3 px-3 menu-item-hover">
                                <i class="menu-icon tf-icons bi bi-file-earmark-text me-3 fs-5"></i>
                                <div class="fw-semibold" data-i18n="Reports">Reports</div>
                            </a>
                        </li>
                    }
                </ul>
            </aside>
            <!-- / Enhanced Animated Menu -->
            <!-- Layout container -->
            <div class="layout-page">
                <!-- Enhanced Modern Navbar -->
                <nav class="enhanced-navbar layout-navbar px-4 mb-4 navbar navbar-expand-xl align-items-center shadow-sm"
                     id="layout-navbar"
                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
           color: #fff !important">
                    <!-- Menu Toggle & Brand (Left Side) -->
                    <div class="navbar-brand-section d-flex align-items-center">
                        <!-- Menu Toggle Button -->
                        <button class="menu-toggle-btn waves-effect me-3" id="navbarMenuToggle">
                            <i class="bi bi-list"></i>
                        </button>
                        <!-- Breadcrumb Navigation -->
                        <nav aria-label="breadcrumb" class="d-none d-xl-block">
                            <ol class="breadcrumb mb-0">
                                <li class="breadcrumb-item">
                                    <a href="@Url.Action("Index", currentController)" class="text-decoration-none text-white">
                                        <i class="bi bi-house-door me-1"></i>Home
                                    </a>
                                </li>
                                <li class="breadcrumb-item active" aria-current="page">
                                    @ViewBag.Title
                                </li>
                            </ol>
                        </nav>
                    </div>

                    <div class="navbar-nav-right d-flex align-items-center justify-content-end" id="navbar-collapse">
                        <!-- Rest of your navbar content remains exactly the same -->
                        <ul class="navbar-nav flex-row align-items-center ms-md-auto">
                            <!-- Calendar -->
                            <li class="nav-item me-3 me-xl-2">
                                <a class="text-black btn btn-icon btn-light rounded-pill waves-effect position-relative calendar-icon" href="@Url.Action("Calender", currentController)">
                                    <i class="bi bi-calendar-event"></i>
                                </a>
                            </li>
                            <!--/ Calendar -->
                            <!-- Notification -->
                            <li class="nav-item dropdown-notifications navbar-dropdown dropdown me-3 me-xl-2">
                                <a class="nav-link dropdown-toggle hide-arrow btn btn-icon btn-light rounded-pill waves-effect position-relative notification-btn"
                                   href="javascript:void(0);"
                                   data-bs-toggle="dropdown" aria-expanded="false">
                                    <span class="position-relative">
                                        <i class="icon-base ri ri-notification-2-line icon-md"></i>
                                        <span id="notificationBadge"
                                              class="badge bg-danger rounded-pill position-absolute notification-badge"
                                              style="top: -5px; right: -5px; min-width: 18px; height: 18px; font-size: 10px; display: flex; align-items: center; justify-content: center;">
                                            0
                                        </span>
                                    </span>
                                </a>

                                <ul class="dropdown-menu dropdown-menu-end p-0 notification-dropdown">
                                    <li class="dropdown-header d-flex justify-content-between align-items-center px-3 pt-3 pb-2">
                                        <span class="fw-semibold">Notifications</span>
                                        <span class="badge bg-primary rounded-pill" id="notificationCount">0</span>
                                    </li>
                                    <li class="dropdown-notifications-list scrollable-container" style="overflow:auto; scrollbar-width:none;">
                                        <ul id="notificationItems" class="list-group list-group-flush">
                                            <li class="list-group-item text-center py-4">
                                                <div class="text-muted">
                                                    <i class="bi bi-bell-slash icon-lg mb-2 d-block"></i>
                                                    No new notifications
                                                </div>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="dropdown-footer border-top p-2">
                                        <div class="d-flex justify-content-between">
                                            <button id="btnMarkAllRead" class="btn btn-sm btn-outline-secondary">
                                                <i class="bi bi-check2-all me-1"></i>Mark all read
                                            </button>
                                            <button id="btnViewAllNotifications" class="btn btn-sm btn-primary">
                                                View all
                                            </button>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <!--/ Notification -->
                            <!-- User -->
                            <li class="nav-item navbar-dropdown dropdown-user dropdown">
                                <a class="nav-link dropdown-toggle hide-arrow p-0 user-avatar-btn"
                                   href="javascript:void(0);"
                                   data-bs-toggle="dropdown">
                                    <div class="avatar avatar-online position-relative">
                                        <img src="~/Content/images/avatars/1.png" alt="" id="layout-profile-photo" class="rounded-circle border border-3 border-white shadow-sm" />
                                    </div>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end p-3 user-dropdown">
                                    <li class="dropdown-header pb-2">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 me-3">
                                                <div class="avatar avatar-online">
                                                    <img src="~/Content/images/avatars/1.png" id="layout-another-photo" alt="" class="w-px-40 h-auto rounded-circle" />
                                                </div>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 id="layout-username" class="mb-0 fw-semibold">John Doe</h6>
                                                <small id="layout-role" class="text-body-secondary">Administrator</small>
                                            </div>
                                        </div>
                                    </li>
                                    <li><hr class="dropdown-divider my-2"></li>
                                    <li>
                                        <a class="dropdown-item d-flex align-items-center" href="@Url.Action("UserProfile",currentController)">
                                            <i class="icon-base ri ri-user-line icon-md me-3 text-primary"></i>
                                            <div>
                                                <span class="d-block fw-medium">My Profile</span>
                                                <small class="text-body-secondary">View your profile</small>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item d-flex align-items-center" href="@($"{Url.Action("UserProfile", currentController)}#update-profile")">
                                            <i class="icon-base ri ri-settings-4-line icon-md me-3 text-success"></i>
                                            <div>
                                                <span class="d-block fw-medium">Update Profile</span>
                                                <small class="text-body-secondary">Manage your account</small>
                                            </div>
                                        </a>
                                    </li>
                                    <li><hr class="dropdown-divider my-2"></li>
                                    <li>
                                        <a class="dropdown-item d-flex align-items-center" href="javascript:void(0)">
                                            <i class="icon-base ri ri-customer-service-2-line icon-md me-3 text-info"></i>
                                            <div>
                                                <span class="d-block fw-medium">Help & Support</span>
                                                <small class="text-body-secondary">Get help and feedback</small>
                                            </div>
                                        </a>
                                    </li>
                                    <li><hr class="dropdown-divider my-2"></li>
                                    <li>
                                        <div class="d-grid">
                                            <a class="btn btn-danger d-flex align-items-center justify-content-center" href="@Url.Action("Logout","Account")">
                                                <i class="ri ri-logout-box-r-line me-2"></i>
                                                <span class="fw-medium">Logout</span>
                                            </a>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <!--/ User -->
                        </ul>
                    </div>
                </nav>
                <!-- / Enhanced Modern Navbar -->
                <!-- Content wrapper -->
                <div class="content-wrapper scroll-container">
                    @RenderBody()
                </div>
                <!-- Content wrapper -->
            </div>
            <!-- / Layout page -->
        </div>

        <!-- Overlay -->
        <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->
    <!-- Global Loader -->
    <div id="globalLoader" class="global-loader" style="display: none;">
      
            <div class="loader"></div>

       
    </div>

    <script>

        // Enhanced Navbar Functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Theme Toggle
            const themeToggle = document.getElementById('themeToggle');
            const lightIcon = themeToggle.querySelector('.light-icon');
            const darkIcon = themeToggle.querySelector('.dark-icon');

            themeToggle.addEventListener('click', function() {
                const html = document.documentElement;
                const isDark = html.getAttribute('data-bs-theme') === 'dark';

                if (isDark) {
                    html.removeAttribute('data-bs-theme');
                    lightIcon.classList.remove('d-none');
                    darkIcon.classList.add('d-none');
                    localStorage.setItem('theme', 'light');
                } else {
                    html.setAttribute('data-bs-theme', 'dark');
                    lightIcon.classList.add('d-none');
                    darkIcon.classList.remove('d-none');
                    localStorage.setItem('theme', 'dark');
                }
            });

            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-bs-theme', 'dark');
                lightIcon.classList.add('d-none');
                darkIcon.classList.remove('d-none');
            }

            // Search functionality
            const searchInput = document.getElementById('navbarSearch');
            const searchClose = document.querySelector('.search-close');

            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    if (this.value.length > 0) {
                        searchClose.classList.remove('d-none');
                    } else {
                        searchClose.classList.add('d-none');
                    }
                });

                searchClose.addEventListener('click', function() {
                    searchInput.value = '';
                    searchClose.classList.add('d-none');
                    searchInput.focus();
                });
            }

            // Navbar scroll effect
            let lastScrollTop = 0;
            const navbar = document.getElementById('layout-navbar');

            window.addEventListener('scroll', function() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                if (scrollTop > lastScrollTop && scrollTop > 100) {
                    // Scrolling down
                    navbar.style.transform = 'translateY(-100%)';
                } else {
                    // Scrolling up
                    navbar.style.transform = 'translateY(0)';
                }

                lastScrollTop = scrollTop;
            });

            // Enhanced notification badge animation
            function animateNotificationBadge() {
                const badge = document.getElementById('notificationBadge');
                if (badge && badge.textContent !== '0') {
                    badge.style.animation = 'none';
                    setTimeout(() => {
                        badge.style.animation = 'pulse 2s infinite';
                    }, 10);
                }
            }

            // Initialize animations
            animateNotificationBadge();

            // Re-animate when notifications update
            const observer = new MutationObserver(animateNotificationBadge);
            const badge = document.getElementById('notificationBadge');
            if (badge) {
                observer.observe(badge, { childList: true, characterData: true, subtree: true });
            }
        });

        // Menu toggle functionality
        document.addEventListener('DOMContentLoaded', function () {
            var roleid = '@role';
            var controllerName = '@currentController';

            if (roleid === '13' || roleid === '14' || roleid === '15') {
                if (controllerName !== 'Quality') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '10' || roleid === '11' || roleid === '12') {
                if (controllerName !== 'GRN') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '2' || roleid === '3' || roleid === '4') {
                if (controllerName !== 'Inventory') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '5' || roleid === '6' || roleid === '7' || roleid === '8' || roleid === '9') {
                if (controllerName !== 'Purchase') {
                    window.location.href = '/Account/Logout';
                }
            }

            const menuToggle = document.querySelector('.layout-menu-toggle');
            const menu = document.querySelector('.layout-menu');
            const overlay = document.querySelector('.layout-overlay');

            if (menuToggle && menu && overlay) {
                menuToggle.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Toggle menu visibility
                    menu.classList.toggle('layout-menu-hidden');

                    // Toggle overlay
                    overlay.classList.toggle('show');

                    // Store menu state in localStorage
                    const isHidden = menu.classList.contains('layout-menu-hidden');
                    localStorage.setItem('menuHidden', isHidden);
                });

                // Close menu when clicking overlay
                overlay.addEventListener('click', function () {
                    menu.classList.add('layout-menu-hidden');
                    overlay.classList.remove('show');
                    localStorage.setItem('menuHidden', true);
                });

                // Check saved state from localStorage
                const menuHidden = localStorage.getItem('menuHidden') === 'true';
                if (menuHidden) {
                    menu.classList.add('layout-menu-hidden');
                    overlay.classList.add('show');
                }
            }

            // Handle window resize
            function handleResize() {
                const menu = document.querySelector('.layout-menu');
                const overlay = document.querySelector('.layout-overlay');

                if (window.innerWidth >= 1200) { // Desktop
                    menu?.classList.remove('layout-menu-hidden');
                    overlay?.classList.remove('show');
                } else { // Mobile
                    const menuHidden = localStorage.getItem('menuHidden') === 'true';
                    if (menuHidden) {
                        menu?.classList.add('layout-menu-hidden');
                    }
                }
            }

            window.addEventListener('resize', handleResize);
            handleResize(); // Initial check
        });

        $(document).ready(function () {
            // Body and general colors
            document.documentElement.style.setProperty('--body-bg', '#f5f5f9');
            document.documentElement.style.setProperty('--navbar-bg', '#ffffff');
            document.documentElement.style.setProperty('--card-bg', '#ffffff');
            document.documentElement.style.setProperty('--card-text', '#6f6b7d');

            // Sidebar/menu specific colors
            document.documentElement.style.setProperty('--sidebar-bg', '#ffffff');
            document.documentElement.style.setProperty('--sidebar-text', '#6f6b7d');
            document.documentElement.style.setProperty('--menu-item-active-bg', 'rgba(105, 108, 255, 0.16)');
            document.documentElement.style.setProperty('--menu-item-active-text', '#000000');
            document.documentElement.style.setProperty('--menu-item-hover-bg', 'rgba(105, 108, 255, 0.08)');

            // Remove dark mode classes from sidebar
            const menu = document.querySelector('.layout-menu');
            menu.classList.add('bg-menu-theme');

            // Load User Info with loader
            showLoader('Loading user information...');
            $.ajax({
                url: '@Url.Action("GetUserInfo", "Account")',
                method: 'GET',
                success: function (res) {
                    if (res.success) {
                        UserInfo = res;
                        var defaultPhoto = '@Url.Content("~/Content/images/avatars/1.png")';
                        $('#layout-username').text(res.userName);
                        $('#layout-department').text(res.department);
                        $('#layout-role').text(res.role);
                        $('#layout-profile-photo').attr('src', res.profilePhoto || defaultPhoto);
                        $('#layout-another-photo').attr('src', res.profilePhoto || defaultPhoto);
                    } else {
                        window.location.href = '/Account/Logout';
                    }
                },
                error: function () {
                    window.location.href = '/Account/Logout';
                },
                complete: function() {
                    hideLoader();
                }
            });

            fetchNotifications();
            setInterval(fetchNotifications, 5000);

            async function fetchNotifications() {
                try {
                    // Check session via AJAX or hidden value
                    const sessionValid = await $.ajax({
                        url: '/Account/CheckSession',
                        type: 'GET'
                    });

                    if (!sessionValid.success) {
                        // Session expired → redirect to logout
                        window.location.href = '/Account/Logout';
                        return;
                    }

                    const notifications = await $.ajax({
                        url: '/Account/GetNotifications',
                        type: 'GET'
                    });

                    const $list = $('#notificationItems');
                    $list.empty();
                    updateNotificationBadge(notifications.length);

                    if (notifications.length > 0) {
                        notifications.forEach(n => {
                            const item = `
                                <li class="list-group-item list-group-item-action dropdown-notifications-item waves-effect d-flex justify-content-between align-items-center">
                                    <span>${n.NotificationMessage}</span>
                                    <button class="btn btn-sm btn-link text-decoration-none mark-read" data-id="${n.NotificationId}"><i class="bi bi-check2-all"></i></button>
                                </li>`;
                            $list.append(item);
                        });
                    } else {
                        $list.html('<li class="list-group-item text-center">No new notifications</li>');
                    }
                } catch (err) { console.error(err); }
            }

            function updateNotificationBadge(count) {
                const badge = $("#notificationBadge");
                const countBadge = $("#notificationCount");

                if (count > 0) {
                    badge.text(count).show();
                    countBadge.text(count);
                } else {
                    badge.hide();
                    countBadge.text('0');
                }
            }

            $(document).on('click', '.mark-read', async function () {
                const id = $(this).data('id');
                showLoader('Updating notification...');
                await $.post('/Account/MarkAsRead', { id: id });
                hideLoader();
                fetchNotifications();
            });

            $('#btnMarkAllRead').click(async function () {
                showLoader('Marking all as read...');
                await $.post('/Account/MarkAllAsRead');
                hideLoader();
                fetchNotifications();
            });

            $('#btnViewAllNotifications').click(async function () {
                showLoader('Loading all notifications...');
                $('#dynamicNotificationsModal').remove(); // remove existing

                const modalHtml = `
                    <div class="modal fade" id="dynamicNotificationsModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-lg modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header bg-primary">
                                    <h5 class="modal-title fw-semibold text-white text-center w-100 pb-4">All Notifications</h5>
                                    <button type="button" class="btn btn-close btn-close-white position-absolute top-0 end-0 m-3 fs-4" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <ul id="allNotificationsList" class="list-group list-group-flush"></ul>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button id="btnModalMarkAllRead" class="btn btn-primary">Mark all as read</button>
                                </div>
                            </div>
                        </div>
                    </div>`;

                $('body').append(modalHtml);

                // Load all notifications
                const allNotifications = await $.ajax({ url: '/Account/GetAllNotifications', type: 'GET' });
                const $allList = $('#allNotificationsList');
                $allList.empty();

                if (allNotifications.length > 0) {
                    allNotifications.forEach(n => {
                        const readClass = n.IsRead ? 'text-muted' : 'fw-bold';
                        const item = `<li class="list-group-item ${readClass}">
                            <span>${n.NotificationMessage}</span>
                        </li>`;
                        $allList.append(item);
                    });
                } else {
                    $allList.html('<li class="list-group-item text-center">No notifications found</li>');
                }

                const modal = new bootstrap.Modal(document.getElementById('dynamicNotificationsModal'));
                modal.show();
                hideLoader();

                // Modal Mark all as read
                $('#btnModalMarkAllRead').click(async function () {
                    showLoader('Marking all as read...');
                    await $.post('/Account/MarkAllAsRead');
                    fetchNotifications();
                    modal.hide();
                    hideLoader();
                });
            });
        });

        // Modal overlay effect fix
        document.addEventListener("DOMContentLoaded", function () {
            function moveModals() {
                document.querySelectorAll(".modal").forEach(function (modal) {
                    if (modal.parentElement !== document.body) {
                        document.body.appendChild(modal);
                    }
                });
            }
            // Initial run
            moveModals();

            // Watch for new modals added dynamically
            const observer = new MutationObserver(moveModals);
            observer.observe(document.body, { childList: true, subtree: true });
        });

        // Menu functionality
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize menu states from server-side classes
            document.querySelectorAll('.menu-item.open').forEach(menuItem => {
                const arrow = menuItem.querySelector('.transition-arrow');
                if (arrow) arrow.style.transform = 'rotate(180deg)';
                const submenu = menuItem.querySelector('.menu-sub');
                if (submenu) {
                    submenu.style.maxHeight = '500px';
                    submenu.style.opacity = '1';
                }
            });

            // Add click handlers to all menu toggles
            document.querySelectorAll('.menu-toggle').forEach(toggle => {
                toggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                    const menuItem = this.closest('.menu-item');
                    const isOpen = menuItem.classList.contains('open');

                    // Close all other open menus
                    document.querySelectorAll('.menu-item.open').forEach(item => {
                        if (item !== menuItem) {
                            closeMenuItem(item);
                        }
                    });

                    // Toggle current menu
                    if (isOpen) {
                        closeMenuItem(menuItem);
                    } else {
                        openMenuItem(menuItem);
                    }
                });
            });

            // Add click handlers to submenu items to prevent menu closing
            document.querySelectorAll('.submenu-item-hover').forEach(item => {
                item.addEventListener('click', function (e) {
                    e.stopPropagation(); // Prevent click from bubbling to parent
                    // Allow normal navigation - menu state will be maintained by server-side
                });
            });
        });

        function openMenuItem(menuItem) {
            menuItem.classList.add('open');
            const arrow = menuItem.querySelector('.transition-arrow');
            if (arrow) arrow.style.transform = 'rotate(180deg)';
            const submenu = menuItem.querySelector('.menu-sub');
            if (submenu) {
                submenu.style.maxHeight = '500px';
                submenu.style.opacity = '1';
            }
        }

        function closeMenuItem(menuItem) {
            menuItem.classList.remove('open');
            const arrow = menuItem.querySelector('.transition-arrow');
            if (arrow) arrow.style.transform = 'rotate(0deg)';
            const submenu = menuItem.querySelector('.menu-sub');
            if (submenu) {
                submenu.style.maxHeight = '0';
                submenu.style.opacity = '0';
            }
        }

        // Global Loader Management
        class LoaderManager {
            constructor() {
                this.requestCount = 0;
                this.loaderElement = document.getElementById('globalLoader');
                this.minimumShowTime = 500; // Minimum show time in ms
                this.maximumShowTime = 10000; // Default max visible time (10s)
                this.startTime = null;
                this.timeoutId = null; // Auto-hide timeout tracker
                this.init();
            }

            init() {
                this.overrideFetch();
                this.overrideJQueryAjax();
                this.overrideXMLHttpRequest();
            }

            show() {
                if (this.requestCount === 0) {
                    this.startTime = Date.now();
                    this.loaderElement.style.display = 'flex';
                    document.body.style.overflow = 'hidden';

                    // Auto-hide loader after max time
                    clearTimeout(this.timeoutId);
                    this.timeoutId = setTimeout(() => {
                        this.forceHide();
                    }, this.maximumShowTime);
                }
                this.requestCount++;
            }

            hide() {
                if (this.requestCount > 0) {
                    this.requestCount--;
                }

                if (this.requestCount === 0) {
                    const elapsed = Date.now() - this.startTime;
                    const remaining = Math.max(0, this.minimumShowTime - elapsed);

                    setTimeout(() => {
                        this.loaderElement.style.display = 'none';
                        document.body.style.overflow = '';
                        clearTimeout(this.timeoutId);
                    }, remaining);
                }
            }

            // Force stop loader immediately
            forceHide() {
                this.requestCount = 0;
                this.loaderElement.style.display = 'none';
                document.body.style.overflow = '';
                clearTimeout(this.timeoutId);
                console.warn('⚠ Loader forcibly hidden after timeout.');
            }

            // Dynamically update max timeout duration
            setMaxTimeout(durationMs) {
                if (typeof durationMs === 'number' && durationMs > 0) {
                    this.maximumShowTime = durationMs;
                    console.info(`⏱ Loader max timeout set to ${durationMs} ms`);
                } else {
                    console.error(' Invalid timeout value. Must be a positive number.');
                }
            }

            // --- Keep rest of your overrides and skip logic unchanged ---
            overrideFetch() { /* same as before */ }
            overrideJQueryAjax() { /* same as before */ }
            overrideXMLHttpRequest() { /* same as before */ }
            shouldSkipLoader(url) { /* same as before */ }
        }

        // Initialize loader manager when DOM is ready
        document.addEventListener('DOMContentLoaded', function () {
            LoaderManager.instance = new LoaderManager();
        });

        // Manual loader control
        window.showLoader = function (text = 'Processing your request...') {
            const loaderText = document.querySelector('.loader-text');
            if (loaderText) loaderText.textContent = text;
            LoaderManager.instance.show();
        };

        window.hideLoader = function () {
            LoaderManager.instance.hide();
        };

        // New function to change loader timeout globally
        window.setLoaderTimeout = function (durationMs) {
            LoaderManager.instance.setMaxTimeout(durationMs);
        };

        // Optional manual force stop
        window.stopLoaderNow = function () {
            LoaderManager.instance.forceHide();
        };

       

        // Handle link clicks that might trigger AJAX
        document.addEventListener('click', function(e) {
            const target = e.target;
            if (target.tagName === 'A' && target.getAttribute('data-ajax') === 'true') {
                e.preventDefault();
                showLoader('Loading...');
                // You can add your AJAX navigation logic here
            }
        });

        // Handle submenu clicks
        function handleSubmenuClick(event) {
            event.stopPropagation();
            // Allow normal navigation
        };

        setLoaderTimeout(1000); // sets max loader time to 5 seconds


        // Navbar Menu Toggle Functionality
        document.addEventListener('DOMContentLoaded', function () {
            const navbarMenuToggle = document.getElementById('navbarMenuToggle');
            const layoutMenu = document.getElementById('layout-menu');
            const layoutOverlay = document.querySelector('.layout-overlay');

            if (navbarMenuToggle && layoutMenu && layoutOverlay) {
                navbarMenuToggle.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Toggle menu visibility
                    layoutMenu.classList.toggle('layout-menu-hidden');

                    // Toggle overlay
                    layoutOverlay.classList.toggle('show');

                    // Store menu state in localStorage
                    const isHidden = layoutMenu.classList.contains('layout-menu-hidden');
                    localStorage.setItem('menuHidden', isHidden);

                    // Add animation class for smooth transition
                    layoutMenu.style.transition = 'all 0.3s ease-in-out';
                });

                // Close menu when clicking overlay
                layoutOverlay.addEventListener('click', function () {
                    layoutMenu.classList.add('layout-menu-hidden');
                    layoutOverlay.classList.remove('show');
                    localStorage.setItem('menuHidden', true);
                });

                // Check saved state from localStorage
                const menuHidden = localStorage.getItem('menuHidden') === 'true';
                if (menuHidden) {
                    layoutMenu.classList.add('layout-menu-hidden');
                } else {
                    layoutMenu.classList.remove('layout-menu-hidden');
                }

                // Handle responsive behavior
                function handleResponsiveMenu() {
                    if (window.innerWidth < 1200) {
                        // Mobile: menu hidden by default
                        if (!localStorage.getItem('menuHidden')) {
                            layoutMenu.classList.add('layout-menu-hidden');
                            layoutOverlay.classList.add('show');
                        }
                    } else {
                        // Desktop: show menu unless explicitly hidden
                        const menuHidden = localStorage.getItem('menuHidden') === 'true';
                        if (!menuHidden) {
                            layoutMenu.classList.remove('layout-menu-hidden');
                            layoutOverlay.classList.remove('show');
                        }
                    }
                }

                // Initial responsive check
                handleResponsiveMenu();

                // Handle window resize
                window.addEventListener('resize', handleResponsiveMenu);
            }
        });

        // Sidebar Toggle Functionality
        document.addEventListener('DOMContentLoaded', function () {
            const navbarMenuToggle = document.getElementById('navbarMenuToggle');
            const layoutMenu = document.getElementById('layout-menu');
            const layoutOverlay = document.querySelector('.layout-overlay');

            function toggleMenu() {
                const isHidden = layoutMenu.classList.contains('layout-menu-hidden');

                if (isHidden) {
                    // Show menu
                    layoutMenu.classList.remove('layout-menu-hidden');
                    layoutOverlay.classList.add('show');
                } else {
                    // Hide menu
                    layoutMenu.classList.add('layout-menu-hidden');
                    layoutOverlay.classList.remove('show');
                }

                // Save state
                localStorage.setItem('menuHidden', !isHidden);
            }

            function closeMenu() {
                layoutMenu.classList.add('layout-menu-hidden');
                layoutOverlay.classList.remove('show');
                localStorage.setItem('menuHidden', true);
            }

            // Initialize menu state
            function initializeMenu() {
                const menuHidden = localStorage.getItem('menuHidden') === 'true';
                if (menuHidden) {
                    layoutMenu.classList.add('layout-menu-hidden');
                    layoutOverlay.classList.remove('show');
                } else {
                    layoutMenu.classList.remove('layout-menu-hidden');
                    if (window.innerWidth < 1200) {
                        layoutOverlay.classList.add('show');
                    }
                }
            }

            // Event listeners
            if (navbarMenuToggle) {
                navbarMenuToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    toggleMenu();
                });
            }

            if (layoutOverlay) {
                layoutOverlay.addEventListener('click', function () {
                    closeMenu();
                });
            }

            // Initialize
            initializeMenu();

            // Handle responsive behavior
            window.addEventListener('resize', function () {
                if (window.innerWidth >= 1200) {
                    layoutOverlay.classList.remove('show');
                } else {
                    const isHidden = layoutMenu.classList.contains('layout-menu-hidden');
                    if (!isHidden) {
                        layoutOverlay.classList.add('show');
                    }
                }
            });
        });

    </script>
</body>
</html>